# 準備

## おまじない
```bat
@echo off
```
デフォルトだと実行したコマンド文そのものが常に標準出力に出力されてしまうので、それを抑制。echo off だけだと、echoコマンド自体が出力されてしまうので@をつけることで非表示にする。@はその行だけ非表示にする機能。

```bat
cd /d %~dp0
```
batファイルはダブルクリックで実行すると、ファイルの置いてあるディレクトリがカレントディレクトリになるが、他のバッチファイルなどから呼び出したときは、そのプログラムのカレントディレクトリを引き継ぐので、事故になりかねない。これを書いておくと、自身のファイルのおいてあるディレクトリがカレントディレクトリになる。

- `%0`
  - `%0, %1, %2`は引数参照とよばれ、バッチに渡される引数
  - `%0`は起動されたバッチのフルパスが格納される
- `~`
  - ダブルクオートをのぞく
- `d`
  - ドライブ文字列の抽出
- `p`
  - ドライブ文字列以外のパスを抽出

```bat
echo %0
@REM "C:\tmp\bat-sample\sample.bat"

echo %~0
@REM C:\tmp\bat-sample\sample.bat

echo %~p0
@REM \tmp\bat-sample\

echo %~dp0
@REM C:\tmp\bat-sample\
```

## 実行方法
- コマンドプロンプトからファイル名を指定してエンター
- エクスプローラーからダブルクリック
- バッチから別バッチファイルの呼び出し
- タスクスケジューラで指定
- スタートアップフォルダーにバッチファイルのショートカットを作成してログイン時に自動実行

## 実行時の注意
### バッチファイルの絶対パスに`(`が含まれる場合
`C:\usr\local\test(1)\sample.bat`のような場合、右クリックメニューから「管理者として実行」を選択すると、実行に失敗する(`C:\usr\local\test.exe`を実行しようとする)。ダブルクリックで実行はできる。

ちなみに、`(`が含まれていてもパスのどこかに半角スペースが入っているとこの不具合は発生しない(`C:\ Program Files (x86)`以下など)。

## 文字コード・改行コード
文字コードはShift_JIS、改行コードはCRLFを使用する。
